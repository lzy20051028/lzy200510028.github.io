---
layout:     post
title:      数据陷阱：技术过失1.2
subtitle:   无尽的拼法错误
date:       2020-07-17
author:     刘政永Dmer
header-img: img/post-bg-dmers.jpg
catalog: true
tags:
    - 听取树蛙一篇
---

不过，我们还是多谈谈“Camray”吧。这个错误的拼写为我们提供了一个窗口，让我们了解到这个数据集的另一个糟糕的方面，即Vehicle Make字段。我们看下这个字段，因为在理论上，它的取值范围应该比车辆模型字段更有限。大多数汽车(如本田-Honda)有许多车型(思域-Civic、雅阁- Accord等)。

结果显示，在我们的数据集中，Vehicle Make字段中实际上有899个不同的条目。下图的词云显示了前100个，按照数据集中条目总数(两个事件)进行字体大小显示。

![]({{site.baseurl}}/img/post-bg-px1.jpg)

这个词云只显示了拖车最多的前100个车型标识。还有799个在整个列表中，我们找到了道奇-Dodge， 但也有Dode、Dodg、Dodg3e、Dodgfe、Dfdge、Dpdge等等。 更别提其他的雪佛兰（Chevrolet）,最逗是把Peterbutt写成Peterbilt。

但说真的，我们该怎么处理这么大的一个烂摊子呢? 我们怎么可能知道在哪段时间内被拖走的最常见的车辆是什么呢?

OpenRefine是一个非常有用的工具，可以免费下载，可用于标识和快速组合列中的类似值，还有其他方便的功能。用OpenRefine打开数据集， 并执行一个在汽车制造领域的聚类功能,在key collision method与ngram-fingerprint选择功能，ngram的大小的设为1,这样就可很快得到每辆车有多少错误值 （按：该软件操作实质上在执行一个文本聚类的算法，感兴趣的同学可以下载安装体验一下）

![]({{site.baseurl}}/img/post-bg-px2.jpg)

这个特定的算法找到了113个不同的类要合并，可以在滚动页面时逐一查审查。 强烈推荐这样做，因为这样会发现算法并不完美。 例如，它想为Dodger和Dodge创建一个集群，并建议将Suzuui(显然是Suzuki的拼写错误)合并到Isuzu类中.

![]({{site.baseurl}}/img/post-bg-px3.jpg)

我们还注意到在下图中Open Refine建议我们为大众汽车(Volkswagen)创建一个独特的集群，对吧?如果你像我第一次那样认为这没什么错， 就会忽略一个事实，那就是这组中四个不同的值都是拼写错误的Volkswagen。 如果滚动一下，会发现算法为正确的拼写建议了一个单独的组，这时候可以进行纠正。 如果这样做，会发现在数据集中有36种不同的拼写方式Volkswagen。

![]({{site.baseurl}}/img/post-bg-px4.jpg)

利用ngram-fingerprint算法快速搜索明显的缺失值，如下图，可以有效地将vhicleMake字段中的不同值从899个减少到仅507个。这大大降低了复杂度。但是我们做完了吗?

![]({{site.baseurl}}/img/post-bg-px5.jpg)

这也很费劲了，但是想象一下，如果必须为vehicleMake字段筛选所有的899个不同的值，那将更加痛苦。 至少，聚类算法将这个数字大致减少到一半。

在对列表进行了大约半小时的检查, 并手动修复了一些明显不正确的条目，这些条目是没有被聚类算法有效分组的，最后得到了336个不同的Vehicle Make值。请注意，我最终还是得到了一些有趣的条目，比如burning Car、Pete、Rocket，以及这个领域的一大堆数字，所以依然并不完美，但已经比刚开始的时候干净多了。

但那又怎样?值得吗?它是如何影响我们的分析的?下图是该数据集数据清理前后的拖车事件的数量，取前25。

![]({{site.baseurl}}/img/post-bg-px6.jpg)

值得注意的是，前两名的汽车制造商本田(Honda )和福特(Ford)仍在前两名， 但分别增长了2454辆(增长46%)和1685辆(增长36%), 在榜单上的位置可能没有改变,但数值上有重大提升。

并不是所有上榜的在榜单上的位置都保持不变。丰田(Toyota)从第4位上升到第3位，雪佛兰(Chevrolet)从第3位下降到第4位。 两者的数量都增加了几千。值得注意的是，Jeep从第15位跃至第10位，而最初甚至没有进入前25位的大众， 经过聚类、合并和数据清理，最终排名至第11位。

可见，对于该数据集，脏数据字段的清理会对我们的分析产生实质性的改变。 以此可以避免一些严重的误解，包括在巴尔的摩哪些车辆被拖得最多，以及哪些品牌的车被拖走的还不算多。

本文转载于知乎海数据实验室。